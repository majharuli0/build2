import{j as t,w as y,r as i,$ as g,C as j,d as S,ac as I,ad as b,a4 as C,ae as _,ag as A,af as N}from"./index-9nBSjLkW.js";import{D as v}from"./index-CfKQOiuf.js";import{R as k}from"./ReportActionModal-DrUh0aeU.js";try{let e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new e.Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="94265bb3-8bd0-4938-8049-e550bca66441",e._sentryDebugIdIdentifier="sentry-dbid-94265bb3-8bd0-4938-8049-e550bca66441")}catch{}function L({row:e}){const n=i.useContext(g),[s,l]=i.useState(e==null?void 0:e.installation_status),[d,o]=i.useState(!1),[c,x]=i.useState(!1),h=r=>{r==="completed"?x(!0):(o(!0),b(e==null?void 0:e._id,{installation_status:r}).then(a=>{n.getList(),a&&l(r)}).catch(a=>{console.log(a),l(e==null?void 0:e.installation_status)}).finally(()=>{o(!1)}))},m=async()=>{o(!0),(e==null?void 0:e.products.filter(a=>(a==null?void 0:a.type)==="AI Monitoring")).length>0&&await C({id:e==null?void 0:e.user_id}).then(a=>{var u;a&&_({subscription_id:(u=a==null?void 0:a.data)==null?void 0:u.subscription_id,extend_day:"30"}).then(()=>{}).catch(p=>{console.log(p)})}).catch(a=>{console.log(a)}),await b(e==null?void 0:e._id,{installation_status:"completed"}).then(a=>{n.getList(),a&&l("completed")}).catch(a=>{console.log(a),l("completed")}).finally(()=>{o(!1)})};return i.useEffect(()=>{l(e==null?void 0:e.installation_status)},[e==null?void 0:e.installation_status]),t.jsxs("div",{className:"flex items-center space-x-2 mr-0 ",children:[t.jsx("span",{className:`w-3 h-3 rounded-full relative -right-2 ${s==="completed"?"bg-[#1EB564]":s==="pending"?"bg-yellow-500":"bg-red-500"}`}),t.jsx(j,{theme:{token:{colorText:"#707EAE",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:t.jsx(S,{value:s,variant:"borderless",onChange:h,loading:d,optionSelectedColor:"#8086AC",className:"w-fit !text-red-100",options:[{value:"completed",label:t.jsx("span",{children:"Complete"})},{value:"pending",label:t.jsx("span",{children:"Pending"})},{value:"not_started",label:t.jsx("span",{children:"Not Started"})}]})}),t.jsx(I,{modalOPen:c,setModalOpen:x,title:"",title2:"Are you sure you want to change the status to 'Completed'? Once confirmed, this action cannot be undone, and user subscription will start immediately from now.",okText:"Confirm",onOk:()=>m()})]})}const P=[{title:"Installation Status",render:e=>t.jsx(L,{row:e})},{title:"Report",render:e=>t.jsx("div",{className:"flex justify-center",children:t.jsx(k,{report:e})})},{title:"Customer Name",render:e=>t.jsx("button",{children:t.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:e==null?void 0:e.user_name})})},{title:"Customer Phone Number",render:e=>t.jsx("button",{children:t.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:e==null?void 0:e.user_phone})})},{title:"Customer Email",render:e=>t.jsx("button",{children:t.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:e==null?void 0:e.user_email})})},{title:"Location",render:e=>{var n,s,l,d,o,c;return t.jsx("button",{children:t.jsxs("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:[(n=e.address)==null?void 0:n.line1,","," ",(s=e.address)!=null&&s.line2?((l=e.address)==null?void 0:l.line2)+", ":"",","," ",(d=e.address)==null?void 0:d.city,", ",(o=e.address)==null?void 0:o.state,","," ",e.address?e.address.postal_code:" ",", ",(c=e.address)==null?void 0:c.country]})})}},{title:"Product Name",render:e=>t.jsx("button",{children:t.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary flex  gap-2",children:e.products.filter((n,s,l)=>{const d=n.type==="Seenyor Kit"&&l.findIndex(o=>o.type==="Seenyor Kit")===s;return!/^AI Sensor/.test(n.type)&&(n.type!=="Seenyor Kit"||d)}).map((n,s)=>{const l=n.type==="Seenyor Kit"?"blue":n.type==="Installation"?"orange":"default";return t.jsx(y,{color:l,children:n.type==="Seenyor Kit"?"Package":n.type},s)})})})},{title:"Product Price",render:e=>t.jsx("button",{children:t.jsxs("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary",children:["$",e.products.filter(n=>["Seenyor Kit","Installation","AI Monitoring"].includes(n.type)).reduce((n,s)=>n+s.price,0).toFixed(2)]})})},{title:"Addon Name",render:e=>t.jsx("button",{children:t.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary flex gap-2",children:e.products.filter(n=>!["Seenyor Kit","Installation","AI Monitoring"].includes(n.type)).map((n,s)=>t.jsx(y,{children:n.type},s)).length===0?t.jsx("span",{children:"--"}):e.products.filter(n=>!["Seenyor Kit","Installation","AI Monitoring"].includes(n.type)).map((n,s)=>t.jsx(y,{children:n.type},s))})})},{title:"Addon Price",render:e=>t.jsx("button",{children:t.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:e.products.map((n,s)=>["Seenyor Kit","Installation","AI Monitoring"].includes(n.type)?null:t.jsxs("span",{children:["$",n.price.toFixed(2)]},s)).filter(Boolean).length===0?t.jsx("span",{children:"--"}):e.products.map((n,s)=>["Seenyor Kit","Installation","AI Monitoring"].includes(n.type)?null:t.jsxs("span",{children:["$",n.price.toFixed(2)]},s))})})},{title:"Total Price",render:e=>t.jsx("button",{children:t.jsxs("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:["$",e.total]})})},{title:"Date of Sales",render:e=>{const n=new Date(e.created_at).toLocaleDateString("en-CA");return t.jsx("button",{children:t.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:n})})}},{title:"Payment Status",dataIndex:"payment_status",key:"payment_status",filters:[{text:"Completed",value:"completed"},{text:"Pending",value:"pending"},{text:"Cancelled",value:"cancelled"}],filterMultiple:!0,onFilter:(e,n)=>n.payment_status.includes(e),render:e=>{let n="";switch(e){case"completed":n="green";break;case"pending":n="orange";break;case"cancelled":n="red";break;default:n="black"}return t.jsx("span",{style:{backgroundColor:n,color:"white",padding:"4px 8px",borderRadius:"4px",fontWeight:500,textTransform:"capitalize"},children:e})}}];function E(){const[e,n]=i.useState(!1),[s,l]=i.useState(1),[d,o]=i.useState(0),[c,x]=i.useState({installation_status:"completed",ne:!0}),[h,m]=i.useState([]),[r,a]=i.useState("Not Installed"),u=[{text:"Not Installed"},{text:"Installed"}],p=i.useCallback(()=>{n(!0),A({...c,page:s}).then(f=>{m(f.data),o(f.total)}).catch(f=>{console.log(f)}).finally(()=>{n(!1)})},[c,s]);return i.useEffect(()=>{p()},[p]),i.useEffect(()=>{x(r==="Installed"?{installation_status:"completed"}:{installation_status:"completed",ne:!0})},[r]),t.jsxs("div",{children:[t.jsx("div",{className:"py-[20px] flex",children:t.jsx(v,{menus:u,activeTab:r,setActiveTab:a})}),t.jsxs("div",{id:"NewInstallation",className:"p-[25px] rounded-2xl  bg-white w-full  h-full",children:[t.jsxs("div",{id:"ChartHeader",className:"w-full flex justify-between mb-8",children:[t.jsx("h1",{className:"text-[24px] font-bold",children:"To Be Installed"}),t.jsx("div",{id:"chartController",className:"flex gap-4"})]}),t.jsx(j,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:t.jsx(g.Provider,{value:{getList:p,total:d,page:s,SetPage:l},children:t.jsx(N,{loading:e,scroll:{x:750},columns:P,tableData:h})})})]})]})}export{E as default};
//# sourceMappingURL=index-DlWMZlTR.js.map
