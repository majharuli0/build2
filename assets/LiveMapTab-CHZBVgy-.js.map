{"version":3,"file":"LiveMapTab-CHZBVgy-.js","sources":["../../src/Pages/Elderlies/Components/TabContents/LiveMap/CurrentPeoples.jsx","../../src/Pages/Elderlies/Components/TabContents/LiveMap/LiveMapTab.jsx"],"sourcesContent":["import React, { useContext, useEffect, useMemo, useState } from \"react\";\r\nimport { WebSocketContext } from \"@/Context/WebSoketHook\";\r\nimport { CustomContext } from \"@/Context/UseCustomContext\";\r\nimport { Tooltip } from \"antd\";\r\nimport { FaUser } from \"react-icons/fa6\";\r\nimport { FaBedPulse } from \"react-icons/fa6\";\r\nimport { decodeMinuteSleepStats } from \"../../../../../utils/helper\";\r\n\r\nexport default function CurrentPeoples({ data = {} }) {\r\n  const { deviceData } = useContext(WebSocketContext);\r\n  const context = useContext(CustomContext);\r\n  const { elderlyDetails } = context || {};\r\n  const deviceCode = data?.device_no || elderlyDetails?.deviceId;\r\n  const [peopleDataState, setPeopleDataState] = useState([]);\r\n\r\n  useEffect(() => {\r\n    const newPeopleData = deviceData[deviceCode]?.position || [];\r\n    setPeopleDataState(newPeopleData);\r\n  }, [deviceData, deviceCode]);\r\n  const currentState = useMemo(() => {\r\n    const device = deviceData[deviceCode];\r\n    const lastUpdate = device?.hbstaticsTimestamp;\r\n    const now = Date.now();\r\n\r\n    if (!device?.hbstatics || !lastUpdate) return null;\r\n\r\n    const diffInSeconds = (now - lastUpdate) / 1000;\r\n    if (diffInSeconds > 90) return null;\r\n\r\n    return device.hbstatics;\r\n  }, [deviceData[deviceCode]]);\r\n\r\n  return (\r\n    <div className=\"flex gap-2 h-fit\">\r\n      <div className=\"top-2 left-2 border-2 p-0 rounded-full flex items-center gap-1 pr-2 h-fit w-fit z-50\">\r\n        {peopleDataState?.length > 0 ? (\r\n          <Tooltip\r\n            color=\"white\"\r\n            overlayInnerStyle={{ color: \"black\", padding: \"10px\" }}\r\n            title={peopleDataState?.map((people, indx) => (\r\n              <div key={indx} className=\"flex items-center gap-2 mb-2\">\r\n                <div\r\n                  style={{ backgroundColor: people?.color }}\r\n                  className=\"p-2 rounded-full\"\r\n                >\r\n                  <FaUser size={14} color=\"white\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm m-0\">{people?.posture}</p>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          >\r\n            <div className=\"flex -space-x-4 cursor-pointer\">\r\n              {peopleDataState?.map((people, indx) => (\r\n                <div\r\n                  key={indx}\r\n                  style={{ backgroundColor: people?.color }}\r\n                  className={`p-1 rounded-full border-2 border-white`}\r\n                >\r\n                  <FaUser size={16} color=\"white\" />\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </Tooltip>\r\n        ) : (\r\n          <div className={`bg-primary p-1 rounded-full border-2 border-white`}>\r\n            <FaUser size={16} color=\"white\" />\r\n          </div>\r\n        )}\r\n        <span className=\"font-bold text-lg\">\r\n          {peopleDataState ? peopleDataState?.length : 0}\r\n        </span>\r\n      </div>\r\n\r\n      {data?.room_type == 2 && (\r\n        <div className=\"top-2 left-2 border-2 p-0 rounded-full flex items-center gap-1 pr-2 h-fit w-fit px-2 py-1\">\r\n          <div className=\"pr-1\">\r\n            <FaBedPulse\r\n              size={20}\r\n              color={`${\r\n                decodeMinuteSleepStats(currentState)?.statusEvents?.sleepState\r\n                  ?.color\r\n              }`}\r\n            />\r\n          </div>\r\n          <span className=\"font-semibold text-wrap\">\r\n            {decodeMinuteSleepStats(currentState)?.statusEvents?.sleepState\r\n              ?.label || \"--\"}\r\n          </span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useContext } from \"react\";\r\nimport Room1 from \"@/Components/RoomMap/RoomMap3\";\r\nimport Room2 from \"@/Components/RoomMap/RoomMap4\";\r\nimport { CustomContext } from \"@/Context/UseCustomContext\";\r\nimport useWebSocket from \"@/hook/useWebSoket\";\r\nimport { decodePosition } from \"@/utils/helper\";\r\nimport { FaUser } from \"react-icons/fa6\";\r\nimport { Tooltip } from \"antd\";\r\nimport CurrentPeoples from \"./CurrentPeoples\";\r\n\r\nexport default function LiveMapTab() {\r\n  const context = useContext(CustomContext);\r\n  const { elderlyDetails } = context || {};\r\n  return (\r\n    <div className=\"flex flex-col gap-4 mt-6 overflow-hidden\">\r\n      {elderlyDetails?.rooms &&\r\n        elderlyDetails?.rooms\r\n          ?.filter((room) => room.device_no)\r\n          .map((room, indx) => {\r\n            return (\r\n              <div\r\n                key={indx}\r\n                className=\"flex flex-col gap-4 bg-white rounded-2xl p-4 h-[700px]\"\r\n              >\r\n                <h1 className=\"text-2xl font-bold\">{room?.name}</h1>\r\n                <div className=\"flex h-full\">\r\n                  <CurrentPeoples data={room} />\r\n                  <div id=\"roomMap\" className=\"w-fit h-full mt-14 mx-auto\">\r\n                    {room?.mount_type === 2 && <Room2 roomInfo={room} />}\r\n                    {room?.mount_type === 1 && <Room1 roomInfo={room} />}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["CurrentPeoples","data","deviceData","useContext","WebSocketContext","context","CustomContext","elderlyDetails","deviceCode","peopleDataState","setPeopleDataState","useState","useEffect","newPeopleData","_a","currentState","useMemo","device","lastUpdate","now","jsxs","jsx","Tooltip","people","indx","FaUser","FaBedPulse","_c","_b","decodeMinuteSleepStats","_f","_e","_d","LiveMapTab","room","Room2","Room1"],"mappings":"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"}