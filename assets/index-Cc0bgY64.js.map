{"version":3,"file":"index-Cc0bgY64.js","sources":["../../src/Components/RefundsModal/RefundsRequestModal.jsx","../../src/Pages/RefundsRequest/utiles.jsx","../../src/Pages/RefundsRequest/index.jsx"],"sourcesContent":["import { useState, useContext } from \"react\";\nimport { Checkbox } from \"antd\";\nimport CustomModal from \"@/Shared/modal/CustomModal\";\nimport { MdInfo } from \"react-icons/md\";\nimport CustomInput from \"@/Shared/input/CustomInput\";\nimport { RiRefund2Line } from \"react-icons/ri\";\nimport { refundRequest } from \"@/api/ordersManage\";\nimport { SidebarContext } from \"@/Context/CustomUsertable\";\nimport toast from \"react-hot-toast\";\nexport default function RefundsRequestModal({ record }) {\n  const [open, setOpen] = useState(false);\n  const onCancel = () => setOpen(false);\n  const [customAmountEnabled, setCustomAmountEnabled] = useState(false);\n  const [customAmount, setCustomAmount] = useState(\"\");\n  const [amount, setAmount] = useState(record.total);\n  const [error, setError] = useState(\"\");\n  const sharedMethod = useContext(SidebarContext);\n\n  console.log(record);\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    let amountToRefund;\n    if (customAmountEnabled) {\n      amountToRefund = customAmount;\n    } else {\n      amountToRefund = amount;\n    }\n    console.log(amountToRefund);\n    refundRequest(record?.transaction_id, { amount: Number(amountToRefund) })\n      .then((res) => {\n        console.log(res);\n        setOpen(false);\n        sharedMethod.getList();\n        toast.success(\"Refund request sent successfully\");\n      })\n      .catch((err) => {\n        console.log(err);\n        toast.error(\n          \"Something went wrong, Please try again or Try From Stripe Dashboard\"\n        );\n      });\n  };\n  return (\n    <>\n      <button\n        onClick={() => setOpen(true)}\n        className=\"flex items-center gap-2 hover:bg-gray-100 p-2 rounded-lg hover:text-primary\"\n      >\n        <RiRefund2Line size={25} />\n        <span className=\"text-base font-medium\">Refund</span>\n      </button>\n      <CustomModal\n        modalOPen={open}\n        setModalOpen={setOpen}\n        onclose={onCancel}\n        buttonText=\"Confirm Refund\"\n        handleSubmit={handleSubmit}\n        title=\"Refund\"\n      >\n        <div>\n          <div\n            id=\"note\"\n            className=\"text-yellow-600 bg-yellow-50/50 rounded-lg p-3 flex flex-col items-start gap-2\"\n          >\n            <MdInfo className=\"text-yellow-600 text-2xl\" />\n            <p className=\"text-[14px] xl:text-base font-normal  \">\n              Refunds can take <b>up to 10 business days</b> to appear in a\n              customer&apos;s account. You can check the status of a refund on\n              the Transaction page or the Payments tab of The Stripe Dashboard.\n            </p>\n          </div>\n          <ul className=\"list-none list-inside flex flex-col gap-2 mt-3\">\n            <li className=\"text-[16px] xl:text-base font-normal flex items-center gap-2\">\n              Transaction ID:{\" \"}\n              <span className=\"font-bold\">{record.transaction_id}</span>\n            </li>\n            <li className=\"text-[16px] xl:text-base font-normal flex items-center gap-2\">\n              Amount: <span className=\"font-bold\">${record.total}</span>\n              <Checkbox\n                checked={customAmountEnabled}\n                onChange={() => setCustomAmountEnabled(!customAmountEnabled)}\n              >\n                Custom amount\n              </Checkbox>\n            </li>\n          </ul>\n          <div className=\"flex flex-col gap-2\">\n            <CustomInput\n              placeholder=\"Enter custom amount\"\n              type=\"number\"\n              //   step=\"0.01\"\n              disabled={!customAmountEnabled}\n              register={{\n                value: customAmount,\n                onChange: (e) => {\n                  const value = e.target.value;\n                  const parsedValue = parseFloat(value);\n\n                  if (value === \"\" || parsedValue <= record.total) {\n                    setCustomAmount(value);\n                    setError(\"\"); // Clear error if valid\n                  } else {\n                    setError(\n                      \"Custom amount must be less than or equal to the total amount.\"\n                    );\n                  }\n                },\n              }}\n              error={{ type: \"required\", message: error }}\n            />\n          </div>\n        </div>\n      </CustomModal>\n    </>\n  );\n}\n","import RefundsRequestModal from \"@/Components/RefundsModal/RefundsRequestModal\";\nimport { Tooltip } from \"antd\";\nimport { useState } from \"react\";\nconst TransactionIdColumn = ({ transactionId }) => {\n  const [copied, setCopied] = useState(false);\n\n  const handleCopy = () => {\n    navigator.clipboard.writeText(transactionId);\n    setCopied(true);\n    setTimeout(() => setCopied(false), 2000); // Reset after 2 seconds\n  };\n\n  return (\n    <Tooltip title={copied ? \"Copied!\" : \"Click to copy\"}>\n      <span\n        className=\"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap cursor-pointer\"\n        onClick={handleCopy}\n      >\n        {transactionId}\n      </span>\n    </Tooltip>\n  );\n};\nexport const refundRequestColumns = [\n  {\n    title: \"Action\",\n    render: (row) => <RefundsRequestModal record={row} />,\n  },\n  {\n    title: \"Transaction ID\",\n    render: (row) => <TransactionIdColumn transactionId={row.transaction_id} />,\n  },\n  {\n    title: \"Office Identifier\",\n    render: (row) => (\n      <button>\n        <span className=\"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap\">\n          {row.office_name}\n        </span>\n      </button>\n    ),\n  },\n  {\n    title: \"Agent Name (ID Number)\",\n    render: (row) => (\n      <button>\n        <span className=\"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap\">\n          {row.agent_name} ({row.agent_unique_id})\n        </span>\n      </button>\n    ),\n  },\n  {\n    title: \"Date of Sales\",\n    render: (row) => {\n      const formattedDate = new Date(row.created_at).toLocaleDateString(\n        \"en-CA\"\n      );\n      return (\n        <button>\n          <span className=\"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap\">\n            {formattedDate}\n          </span>\n        </button>\n      );\n    },\n  },\n  {\n    title: \"Product Name\",\n    render: (row) => (\n      <button>\n        <span className=\"text-[14px] xl:text-base font-normal text-text-secondary flex flex-col gap-2\">\n          {row.products\n            .filter(\n              (item, indx, self) =>\n                item.type !== \"Seenyor Kit\" ||\n                self.findIndex((i) => i.type === \"Seenyor Kit\") === indx\n            )\n            .map(\n              (item, indx) =>\n                [\"Seenyor Kit\", \"Installation\"].includes(item.type) &&\n                indx < 2 && <span key={indx}>{item.type}</span>\n            )}\n        </span>\n      </button>\n    ),\n  },\n  {\n    title: \"Product Price\",\n    render: (row) => (\n      <button>\n        <span className=\"text-[14px] xl:text-base font-normal text-text-secondary\">\n          $\n          {row.products\n            .filter((item) =>\n              [\"Seenyor Kit\", \"Installation\", \"AI Monitoring\"].includes(\n                item.type\n              )\n            )\n            .reduce((total, item) => total + item.price, 0)\n            .toFixed(2)}\n        </span>\n      </button>\n    ),\n  },\n  {\n    title: \"Addon Name\",\n    render: (row) => (\n      <button>\n        <span className=\"text-[14px] xl:text-base font-normal text-text-secondary flex flex-col gap-2\">\n          {row.products.map(\n            (item, indx) =>\n              ![\"Seenyor Kit\", \"Installation\", \"AI Monitoring\"].includes(\n                item.type\n              ) && <span key={indx}>{item.type}</span>\n          )}\n        </span>\n      </button>\n    ),\n  },\n  {\n    title: \"Addon Price\",\n    render: (row) => (\n      <button>\n        <span className=\"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap\">\n          {row.products.map(\n            (item, indx) =>\n              ![\"Seenyor Kit\", \"Installation\", \"AI Monitoring\"].includes(\n                item.type\n              ) && <span key={indx}>${item.price.toFixed(2)}</span>\n          )}\n        </span>\n      </button>\n    ),\n  },\n  {\n    title: \"Total Price\",\n    render: (row) => (\n      <button>\n        <span className=\"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap\">\n          ${row.total.toFixed(2)}\n        </span>\n      </button>\n    ),\n  },\n  {\n    title: \"Installation Status\",\n    render: (row) => {\n      let bgColor;\n      switch (row.installation_status) {\n        case \"not_started\":\n          bgColor = \"bg-[#5d5d5d]\";\n          break;\n        case \"pending\":\n          bgColor = \"bg-[#833af1]\";\n          break;\n        case \"completed\":\n          bgColor = \"bg-[#36b610]\";\n          break;\n        default:\n          bgColor = \"bg-black\";\n      }\n      const statusMapping = {\n        not_started: \"Not Started\",\n        pending: \"Pending\",\n        completed: \"Completed\",\n      };\n      return (\n        <button>\n          <span\n            className={`text-[14px] xl:text-base capitalize font-normal text-white p-2 px-3 py-1 ${bgColor} rounded-lg`}\n          >\n            {statusMapping[row.installation_status]}\n          </span>\n        </button>\n      );\n    },\n  },\n];\n","import { useEffect, useState } from \"react\";\nimport { refundRequestColumns } from \"./utiles\";\nimport CustomTable from \"@/Shared/Table/CustomTable\";\nimport { SidebarContext } from \"@/Context/CustomUsertable\";\nimport { getOrders } from \"@/api/ordersManage\";\n\nexport default function RefundsRequest() {\n  const [refundsRequest, setRefundsRequest] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [page, SetPage] = useState({});\n  function getRefundsRequest() {\n    setLoading(true);\n    getOrders({\n      payment_status: \"pending\",\n      is_refund_requested: true,\n      ...page,\n    }).then((res) => {\n      setRefundsRequest(res);\n      console.log(res?.data);\n      setLoading(false);\n    });\n  }\n  useEffect(() => {\n    getRefundsRequest();\n  }, [page]);\n  return (\n    <>\n      <div\n        id=\"refunds_request\"\n        className=\"w-full flex flex-col gap-4 justify-center items-center bg-white rounded-2xl p-6 mt-6\"\n      >\n        <div\n          id=\"Recently_Closed_Alerts_Header\"\n          className=\"w-full flex justify-between\"\n        >\n          <h1 className=\"text-[24px] font-bold text-primary\">All Request</h1>\n        </div>\n        <SidebarContext.Provider\n          value={{\n            total: refundsRequest?.total,\n            page,\n            SetPage,\n            getList: getRefundsRequest,\n          }}\n        >\n          <CustomTable\n            loading={loading}\n            columns={refundRequestColumns}\n            tableData={refundsRequest?.data}\n          />\n        </SidebarContext.Provider>\n      </div>\n    </>\n  );\n}\n"],"names":["RefundsRequestModal","record","open","setOpen","useState","onCancel","customAmountEnabled","setCustomAmountEnabled","customAmount","setCustomAmount","amount","setAmount","error","setError","sharedMethod","useContext","SidebarContext","handleSubmit","e","amountToRefund","refundRequest","res","toast","err","jsxs","Fragment","jsx","RiRefund2Line","CustomModal","MdInfo","Checkbox","CustomInput","value","parsedValue","TransactionIdColumn","transactionId","copied","setCopied","handleCopy","Tooltip","refundRequestColumns","row","formattedDate","item","indx","self","i","total","bgColor","statusMapping","RefundsRequest","refundsRequest","setRefundsRequest","loading","setLoading","page","SetPage","getRefundsRequest","getOrders","useEffect","CustomTable"],"mappings":"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"}