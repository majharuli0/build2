{"version":3,"file":"barChart-ArjxN0P9.js","sources":["../../src/Components/GraphAndChart/barChart.jsx"],"sourcesContent":["import React, { useMemo, useState, useEffect } from \"react\";\r\nimport ReactECharts from \"echarts-for-react\";\r\nimport ls from \"store2\";\r\nimport { formatTimeToHoursAndMinutes } from \"@/utils/helper\";\r\nimport { Empty } from \"antd\";\r\nimport dayjs from \"dayjs\";\r\n\r\nexport default function BarChart({\r\n  data,\r\n  dataType,\r\n  color,\r\n  chartType = \"Day\",\r\n  toDate,\r\n  fromDate,\r\n  xUnit = \"date\",\r\n  hourLimit = 12,\r\n  numberLimit = 100,\r\n  dataUnit = \"\",\r\n  chartFor = \"\",\r\n}) {\r\n  const options = useMemo(() => {\r\n    if (!data?.length) {\r\n      return null;\r\n    }\r\n\r\n    const getAllDatesInRange = (start, end) => {\r\n      const dates = [];\r\n      const current = new Date(start);\r\n      const endDate = new Date(end);\r\n\r\n      while (current <= endDate) {\r\n        dates.push(new Date(current).toISOString().split(\"T\")[0]);\r\n        current.setDate(current.getDate() + 1);\r\n      }\r\n      return dates;\r\n    };\r\n\r\n    function generateSleepDistribution(data) {\r\n      const bucketSize = 10; // Bucket size in minutes (e.g., every 10 minutes)\r\n      const minBucket = 60; // Minimum bucket range (1 hour)\r\n      const maxBucket = 720; // Maximum bucket range (12 hours)\r\n\r\n      // Generate x-axis labels for time ranges (e.g., \"1 hr\", \"1 hr 10 min\")\r\n      const xaxis = Array.from(\r\n        { length: (maxBucket - minBucket) / bucketSize + 1 },\r\n        (_, i) => {\r\n          const totalMinutes = minBucket + i * bucketSize;\r\n          const hours = Math.floor(totalMinutes / 60);\r\n          const minutes = totalMinutes % 60;\r\n          return minutes === 0 ? `${hours} hr` : `${hours} hr ${minutes} min`;\r\n        }\r\n      );\r\n\r\n      // Initialize bucket counts (all set to 0 initially)\r\n      const bucketCounts = new Array(xaxis.length).fill(0);\r\n\r\n      // Count the number of items in each bucket\r\n      data?.forEach((item) => {\r\n        const bucketIndex = Math.floor(\r\n          (item.sleep_total_time - minBucket) / bucketSize\r\n        );\r\n        if (bucketIndex >= 0 && bucketIndex < bucketCounts.length) {\r\n          bucketCounts[bucketIndex]++;\r\n        }\r\n      });\r\n\r\n      // Calculate the percentage distribution of items in each bucket\r\n      const totalCounts = bucketCounts.reduce((sum, count) => sum + count, 0);\r\n      const distribution = bucketCounts.map((count) =>\r\n        totalCounts > 0 ? ((count / totalCounts) * 100).toFixed(0) : \"0\"\r\n      );\r\n\r\n      // Return x-axis labels and distribution\r\n      return { xaxis, data: distribution };\r\n    }\r\n\r\n    function generateSleepEfficiencyDistribution(data) {\r\n      const bucketSize = 10; // Grouping size for sleep efficiency ranges\r\n      const minBucket = 0; // Minimum sleep efficiency percentage\r\n      const maxBucket = 100; // Maximum sleep efficiency percentage\r\n\r\n      // Generate x-axis labels (e.g., \"10-20\", \"20-30\")\r\n      const xaxis = Array.from(\r\n        { length: (maxBucket - minBucket) / bucketSize },\r\n        (_, i) =>\r\n          `${minBucket + i * bucketSize}-${minBucket + (i + 1) * bucketSize}`\r\n      );\r\n\r\n      // Initialize bucket counts for each range\r\n      const bucketCounts = new Array(xaxis.length).fill(0);\r\n\r\n      // Count the number of days falling into each bucket\r\n      data?.forEach((item) => {\r\n        const bucketIndex = Math.floor(\r\n          chartFor !== \"deepSleepPercentageDistribution\"\r\n            ? item?.sleep_efficiency / bucketSize\r\n            : item?.sleep_quality / bucketSize\r\n        );\r\n        if (bucketIndex >= 0 && bucketIndex < bucketCounts.length) {\r\n          bucketCounts[bucketIndex]++;\r\n        }\r\n      });\r\n\r\n      // Calculate the total number of days\r\n      const totalDays = data.length;\r\n\r\n      // Calculate the distribution percentages for the y-axis\r\n      const distribution = bucketCounts.map((count) =>\r\n        totalDays > 0 ? ((count / totalDays) * 100).toFixed(0) : \"0\"\r\n      );\r\n      ls.set(chartFor, { xaxis, data: distribution });\r\n      // Return the distribution data with x-axis labels and percentages\r\n      return { xaxis, data: distribution };\r\n    }\r\n\r\n    function generateApneaIndexDistribution(data) {\r\n      const bucketSize = 5; // Grouping by 5 units for the Apnea Index\r\n      const minBucket = 0; // Start at 0\r\n      const maxBucket = 30; // End at 30 (Apnea Index range)\r\n\r\n      // Generate x-axis labels for ranges (e.g., \"0-5\", \"5-10\", \"10-15\", ..., \"25-30\")\r\n      const xaxis = Array.from(\r\n        { length: maxBucket / bucketSize },\r\n        (_, i) => `${i * bucketSize}-${(i + 1) * bucketSize}`\r\n      );\r\n\r\n      // Initialize bucket counts for each Apnea Index range\r\n      const bucketCounts = new Array(xaxis.length).fill(0);\r\n\r\n      // Count the number of days falling into each Apnea Index bucket\r\n      data?.forEach((item) => {\r\n        const ahiValue = parseFloat(item.ahi);\r\n        const bucketIndex = Math.floor(ahiValue / bucketSize); // Group by bucket size of 5\r\n        if (bucketIndex >= 0 && bucketIndex < bucketCounts.length) {\r\n          bucketCounts[bucketIndex]++;\r\n        }\r\n      });\r\n\r\n      // Calculate the total number of days\r\n      const totalDays = data.length;\r\n\r\n      // Calculate the distribution percentages for the y-axis\r\n      const distribution = bucketCounts.map((count) =>\r\n        totalDays > 0 ? ((count / totalDays) * 100).toFixed(0) : \"0\"\r\n      );\r\n\r\n      // Return the distribution data with x-axis labels and percentages\r\n      return { xaxis, data: distribution };\r\n    }\r\n    function generateFallAsleepDurationDistribution(data) {\r\n      const bucketSize = 10; // Grouping by 10 minutes\r\n      const minBucket = 0; // Start at 0 minutes\r\n      const maxBucket = 120; // End at 120 minutes\r\n\r\n      // Generate x-axis labels for ranges (e.g., \"0-10\", \"10-20\", ..., \"110-120\")\r\n      const xaxis = Array.from(\r\n        { length: maxBucket / bucketSize },\r\n        (_, i) => `${i * bucketSize}-${(i + 1) * bucketSize}`\r\n      );\r\n\r\n      // Initialize bucket counts for each Fall Asleep Duration range\r\n      const bucketCounts = new Array(xaxis.length).fill(0);\r\n\r\n      // Count the number of days falling into each Fall Asleep Duration bucket\r\n      data?.forEach((item) => {\r\n        const duration = item.totalFallAsleepDuration;\r\n        const bucketIndex = Math.floor(duration / bucketSize); // Group by bucket size of 10\r\n        if (bucketIndex >= 0 && bucketIndex < bucketCounts.length) {\r\n          bucketCounts[bucketIndex]++;\r\n        }\r\n      });\r\n\r\n      // Calculate the total number of days\r\n      const totalDays = data.length;\r\n\r\n      // Calculate the distribution percentages for the y-axis\r\n      const distribution = bucketCounts.map((count) =>\r\n        totalDays > 0 ? ((count / totalDays) * 100).toFixed(0) : \"0\"\r\n      );\r\n\r\n      // Return the distribution data with x-axis labels and percentages\r\n      return { xaxis, data: distribution };\r\n    }\r\n\r\n    // function generateBreathRateDistribution(data) {\r\n    //   const minBreathRate = 6; // Minimum breath rate\r\n    //   const maxBreathRate = 36; // Maximum breath rate\r\n\r\n    //   // Initialize counts for each breath rate\r\n    //   const breathRateCounts = new Array(\r\n    //     maxBreathRate - minBreathRate + 1\r\n    //   ).fill(0);\r\n\r\n    //   // Count occurrences of each avg breath rate\r\n    //   data?.forEach((item) => {\r\n    //     const avgRate = Math.round(item.avg); // Round avg rate to nearest integer\r\n    //     if (avgRate >= minBreathRate && avgRate <= maxBreathRate) {\r\n    //       const index = avgRate - minBreathRate;\r\n    //       breathRateCounts[index]++;\r\n    //     }\r\n    //   });\r\n\r\n    //   // Calculate total entries\r\n    //   const totalEntries = data.length;\r\n\r\n    //   // Calculate the percentage for each breath rate\r\n    //   const distribution = breathRateCounts.map((count) =>\r\n    //     totalEntries > 0 ? ((count / totalEntries) * 100).toFixed(0) : \"0\"\r\n    //   );\r\n\r\n    //   // Create x-axis labels (6 to 36)\r\n    //   const xaxis = Array.from(\r\n    //     { length: maxBreathRate - minBreathRate + 1 },\r\n    //     (_, i) => (minBreathRate + i).toString()\r\n    //   );\r\n\r\n    //   return { xaxis, data: distribution };\r\n    // }\r\n    function calculateBreathRateDistribution(data) {\r\n      // Breath rate range [6 to 36]\r\n      const breathRateRange = Array.from({ length: 31 }, (_, i) => i + 6); // [6, 7, ..., 36]\r\n\r\n      const result = {\r\n        xaxis: breathRateRange.map((rate) => rate.toString()), // X-axis values for 6-36\r\n        data: Array(31).fill(0), // Initialize with zeros for each breath rate in the range (6-36)\r\n      };\r\n\r\n      let totalCounts = Array(31).fill(0); // Sum of counts for each rate (6-36) across all days\r\n\r\n      // Iterate over each day's data\r\n      data.forEach((day) => {\r\n        // Filter out invalid breath rates (-1 and 0), and convert the valid data to numbers\r\n        const validData = day.data_list\r\n          .filter((value) => value !== \"-1\" && value !== \"0\")\r\n          .map(Number);\r\n\r\n        // Create an array to hold counts for each rate (6-36) for this day\r\n        let dayCounts = Array(31).fill(0);\r\n\r\n        validData.forEach((rate) => {\r\n          if (rate >= 6 && rate <= 36) {\r\n            const index = rate - 6; // Map rate to index (6 -> index 0, 7 -> index 1, ..., 36 -> index 30)\r\n            dayCounts[index]++;\r\n          }\r\n        });\r\n\r\n        // Sum up the counts for the current day for each rate\r\n        dayCounts.forEach((count, index) => {\r\n          totalCounts[index] += count;\r\n        });\r\n      });\r\n\r\n      // Identify the valid range (first and last non-zero index)\r\n      const validIndices = totalCounts\r\n        .map((count, index) => (count > 0 ? index : null))\r\n        .filter((index) => index !== null);\r\n\r\n      if (validIndices.length === 0) {\r\n        return result; // If no valid data, return result with all zeros\r\n      }\r\n\r\n      const validStart = Math.max(validIndices[0] - 1, 0);\r\n      const validEnd = Math.min(validIndices[validIndices.length - 1] + 1, 30);\r\n\r\n      // Calculate the total count within the valid range\r\n      const validTotal = totalCounts\r\n        .slice(validStart, validEnd + 1)\r\n        .reduce((sum, count) => sum + count, 0);\r\n\r\n      // Calculate distributed percentages within the valid range\r\n      result.data = totalCounts.map((count, index) => {\r\n        if (index >= validStart && index <= validEnd && validTotal > 0) {\r\n          return ((count / validTotal) * 100).toFixed(2);\r\n        }\r\n        return \"0.00\";\r\n      });\r\n\r\n      // Return the result in the required format\r\n      return result;\r\n    }\r\n\r\n    const heartRateRanges = [\r\n      \"45-50\",\r\n      \"50-55\",\r\n      \"55-60\",\r\n      \"60-65\",\r\n      \"65-70\",\r\n      \"70-75\",\r\n      \"75-80\",\r\n      \"80-85\",\r\n      \"85-90\",\r\n      \"90-95\",\r\n      \"95-100\",\r\n      \"100-105\",\r\n      \"105-110\",\r\n      \"110-115\",\r\n      \"115-120\",\r\n    ];\r\n    const calculateHeartRateDistribution = (data) => {\r\n      // Initialize a count array for each range\r\n      const rangeCounts = new Array(heartRateRanges.length).fill(0);\r\n      // Loop through each day's data\r\n      data?.forEach((day) => {\r\n        day.data_list.forEach((value) => {\r\n          if (value > 0) {\r\n            // Consider only valid values (excluding 0 or negative values)\r\n            // Find which range this value falls into and increment the corresponding count\r\n            for (let i = 0; i < heartRateRanges.length; i++) {\r\n              const [min, max] = heartRateRanges[i].split(\"-\").map(Number);\r\n              if (value >= min && value < max) {\r\n                rangeCounts[i] += 1;\r\n                break; // Once the correct range is found, break out of the loop\r\n              }\r\n            }\r\n          }\r\n        });\r\n      });\r\n\r\n      // Calculate total valid values across all days\r\n      const totalValidValues = data?.reduce(\r\n        (sum, day) => sum + day.data_list.filter((value) => value > 0).length,\r\n        0\r\n      );\r\n\r\n      // Calculate the percentage for each range\r\n      const distribution = rangeCounts.map((count) =>\r\n        ((count / totalValidValues) * 100).toFixed(0)\r\n      );\r\n\r\n      return {\r\n        xaxis: heartRateRanges,\r\n        data: distribution,\r\n      };\r\n    };\r\n    const getChartData = () => {\r\n      if (xUnit === \"number\") {\r\n        if (chartFor === \"apneaIndexDistribution\") {\r\n          const { xaxis, data: distribution } =\r\n            generateApneaIndexDistribution(data);\r\n\r\n          return xaxis.map((label, index) => ({\r\n            number: label,\r\n            value: distribution[index],\r\n          }));\r\n        } else if (chartFor === \"heartRateDistribution\") {\r\n          const { xaxis, data: distribution } =\r\n            calculateHeartRateDistribution(data);\r\n\r\n          // Combine xaxis and distribution into chart data\r\n          return xaxis.map((label, index) => ({\r\n            number: label,\r\n            value: distribution[index],\r\n          }));\r\n        } else if (chartFor === \"breathRateDistribution\") {\r\n          const { xaxis, data: distribution } =\r\n            calculateBreathRateDistribution(data);\r\n\r\n          // Combine xaxis and distribution into chart data\r\n          return xaxis.map((label, index) => ({\r\n            number: label,\r\n            value: distribution[index],\r\n          }));\r\n        }\r\n      }\r\n      if (xUnit === \"hour\") {\r\n        // Ensure data is valid\r\n        if (data && data.length > 0 && chartFor === \"durationDistribution\") {\r\n          const { xaxis, data: distribution } = generateSleepDistribution(data);\r\n\r\n          // Combine xaxis and distribution into chart data\r\n          return xaxis.map((label, index) => ({\r\n            hour: label,\r\n            percentage: parseInt(label, 10), // Use calculated percentage\r\n            value: distribution[index], // Convert xaxis label back to a numeric value for display\r\n          }));\r\n        } else if (\r\n          data &&\r\n          data.length > 0 &&\r\n          chartFor === \"fallAsleepDurationDistribution\"\r\n        ) {\r\n          const { xaxis, data: distribution } =\r\n            generateFallAsleepDurationDistribution(data);\r\n\r\n          // Combine xaxis and distribution into chart data\r\n          return xaxis.map((label, index) => ({\r\n            hour: label,\r\n            percentage: parseInt(label, 10), // Use calculated percentage\r\n            value: distribution[index], // Convert xaxis label back to a numeric value for display\r\n          }));\r\n        } else {\r\n          // Generate empty dataset if no data is present\r\n          return Array.from({ length: hourLimit }, (_, i) => ({\r\n            hour: i,\r\n            value: 0,\r\n            percentage: 0,\r\n          }));\r\n        }\r\n      } else if (xUnit === \"percentage\") {\r\n        if (\r\n          chartFor === \"efficiencyDistribution\" ||\r\n          chartFor === \"deepSleepPercentageDistribution\"\r\n        ) {\r\n          const { xaxis, data: distribution } =\r\n            generateSleepEfficiencyDistribution(data);\r\n\r\n          // Combine xaxis and distribution into chart data\r\n          return xaxis.map((label, index) => ({\r\n            percentage: label,\r\n            value: distribution[index], // Convert xaxis label back to a numeric value for display\r\n          }));\r\n        } else {\r\n          // Generate array of percentages from 0 to 100 (by 10s)\r\n          const percentages = Array.from({ length: 11 }, (_, i) => i * 10);\r\n          // Create a map of existing data\r\n          const dataMap = new Map(\r\n            data.map((item) => [\r\n              Math.floor(item.sleep_efficiency / 10) * 10, // Round to nearest 10\r\n              {\r\n                value: item.sleep_efficiency,\r\n                date: item.date,\r\n              },\r\n            ])\r\n          );\r\n\r\n          // Create complete dataset with 0 for missing percentages\r\n          return percentages.map((percentage) => ({\r\n            percentage,\r\n            value: dataMap.get(percentage)?.value || 0,\r\n            date: dataMap.get(percentage)?.date || null,\r\n          }));\r\n        }\r\n      } else {\r\n        // Existing date-based logic\r\n        const getAllDatesInRange = (start, end) => {\r\n          const dates = [];\r\n          const current = new Date(start);\r\n          const endDate = new Date(end);\r\n\r\n          while (current <= endDate) {\r\n            dates.push(new Date(current).toISOString().split(\"T\")[0]);\r\n            current.setDate(current.getDate() + 1);\r\n          }\r\n          return dates;\r\n        };\r\n\r\n        const allDates = getAllDatesInRange(fromDate, toDate);\r\n        const dataMap = new Map(\r\n          data?.map((item) => [\r\n            item?.date?.split(\"T\")[0] ||\r\n              (chartFor === \"roomInOut\" ||\r\n              chartFor === \"walkingStepsStatistix\" ||\r\n              chartFor === \"walkingSpeedStatistic\"\r\n                ? dayjs(item.datestr).subtract(1, \"day\").format(\"YYYY-MM-DD\")\r\n                : item?.datestr),\r\n            item.ratio ||\r\n              (chartFor === \"walkingSpeedStatistic\" &&\r\n                item?.user_activity?.speed) ||\r\n              item.bed_exit_duration ||\r\n              item.value ||\r\n              item.sleep_time ||\r\n              item.ahi ||\r\n              (chartFor === \"walkingStepsStatistix\" &&\r\n                item?.user_activity?.step_number) ||\r\n              item.anomalyHeartRate ||\r\n              item.sleep_efficiency ||\r\n              (item.leave_bed_count && chartFor === \"numberOfBedExitTime\"\r\n                ? item.leave_bed_count\r\n                : null) ||\r\n              (item.sleep_quality &&\r\n              chartFor !== \"numberOfBedExitTime\" &&\r\n              chartFor !== \"roomInOut\" &&\r\n              chartFor === \"deepSleepPercentageStatistic\"\r\n                ? item.sleep_quality\r\n                : null) ||\r\n              (item?.user_activity?.entry_room_count && chartFor === \"roomInOut\"\r\n                ? item?.user_activity.entry_room_count\r\n                : null) ||\r\n              (chartFor === \"sleedDurationStatistic\" &&\r\n                item.sleep_total_time) ||\r\n              item.totalFallAsleepDuration ||\r\n              \"--\",\r\n          ])\r\n        );\r\n\r\n        return allDates.map((date) => ({\r\n          date,\r\n          value: dataMap.get(date) || 0,\r\n        }));\r\n      }\r\n    };\r\n\r\n    const chartData = getChartData();\r\n\r\n    const formatValue = (value, type = \"axis\") => {\r\n      if (xUnit === \"percentage\" || dataType === \"percentage\") {\r\n        return `${value}%`;\r\n      }\r\n      if (dataType === \"duration\") {\r\n        const hours = Math.floor(value / 60);\r\n        const minutes = value % 60;\r\n        return hours > 0 ? `${hours}h ${minutes}m` : `${minutes}m`;\r\n      }\r\n\r\n      return value;\r\n    };\r\n\r\n    const formatXAxis = (value) => {\r\n      if (xUnit === \"number\") {\r\n        return value?.toString();\r\n      }\r\n      if (xUnit === \"hour\") {\r\n        return `${value}`;\r\n      }\r\n      if (xUnit === \"percentage\") {\r\n        return `${value}%`;\r\n      }\r\n      if (chartType === \"Week\") {\r\n        const weekNames = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\r\n        const dateObj = new Date(value);\r\n        return weekNames[dateObj.getDay()];\r\n      }\r\n      const dateObj = new Date(value);\r\n      return dateObj\r\n        .toLocaleDateString(\"en-US\", {\r\n          month: \"2-digit\",\r\n          day: \"2-digit\",\r\n        })\r\n        .replace(\"/\", \"-\");\r\n    };\r\n\r\n    return {\r\n      xAxis: {\r\n        type: \"category\",\r\n        data: chartData.map((item) =>\r\n          xUnit === \"hour\"\r\n            ? formatXAxis(item.hour)\r\n            : xUnit === \"percentage\"\r\n            ? formatXAxis(item.percentage)\r\n            : xUnit === \"number\"\r\n            ? formatXAxis(item.number)\r\n            : formatXAxis(item.date)\r\n        ),\r\n      },\r\n\r\n      grid: {\r\n        top: \"5%\",\r\n        left: \"8%\",\r\n        bottom: \"5%\",\r\n        right: \"2%\",\r\n      },\r\n      yAxis: {\r\n        type: \"value\",\r\n        axisLabel: {\r\n          formatter: formatValue,\r\n        },\r\n        max:\r\n          xUnit === \"percentage\" || dataType === \"percentage\" ? 100 : undefined,\r\n      },\r\n      series: [\r\n        {\r\n          data: chartData.map((item) => item.value),\r\n          type: \"bar\",\r\n          barWidth: 10,\r\n          itemStyle: {\r\n            color: color || \"#000\",\r\n            borderRadius: [50, 50, 0, 0],\r\n          },\r\n        },\r\n      ],\r\n      tooltip: {\r\n        trigger: \"axis\",\r\n        formatter: (params) => {\r\n          if (xUnit === \"number\") {\r\n            if (chartFor !== \"apneaIndexDistribution\") {\r\n              const item = chartData[params[0].dataIndex];\r\n              return `<div style=\"margin-top: 4px\">\r\n              <span >${item.value}%</span>\r\n              <br>\r\n              <span style=\"font-weight: bold\">${item.number} BPM</span>\r\n              </div>`;\r\n            } else {\r\n              const item = chartData[params[0].dataIndex];\r\n              return `<div style=\"margin-top: 4px\">\r\n              <span style=\"font-weight: bold\">${item.value}%</span>\r\n              <br>\r\n              <span style=\"font-weight: normal\">${item.number}</span>\r\n              </div>`;\r\n            }\r\n          } else if (xUnit === \"hour\") {\r\n            const item = chartData[params[0].dataIndex];\r\n            return `<div style=\"margin-top: 4px\">\r\n                    ${item.value ? `<span>${item.value}%</span>` : \"--\"}\r\n                    <br>\r\n                    <span style=\"font-weight: bold\">${item.hour}</span>\r\n                    </div>`;\r\n          } else if (xUnit === \"percentage\") {\r\n            const item = chartData[params[0].dataIndex];\r\n            if (item.date) {\r\n              const fullDate = new Date(item.date)\r\n                .toLocaleDateString(\"en-US\", {\r\n                  year: \"numeric\",\r\n                  month: \"2-digit\",\r\n                  day: \"2-digit\",\r\n                })\r\n                .replace(/\\//g, \"-\");\r\n              return `<div style=\"font-weight: bold\">${item.value}%</div>\r\n                     <div style=\"margin-top: 4px\">${fullDate}</div>`;\r\n            }\r\n            return `<div style=\"font-weight: bold\"> ${item.value}% <br/> <span style=\"font-weight: normal\">${item.percentage}%</span></div>`;\r\n          }\r\n\r\n          const date = chartData[params[0].dataIndex].date;\r\n          const fullDate = new Date(date)\r\n            .toLocaleDateString(\"en-US\", {\r\n              year: \"numeric\",\r\n              month: \"2-digit\",\r\n              day: \"2-digit\",\r\n            })\r\n            .replace(/\\//g, \"-\");\r\n\r\n          return `<div style=\"font-weight: bold\">${fullDate}</div>\r\n                  <div style=\"margin-top: 4px\">${formatValue(\r\n                    params[0].value\r\n                  )}${dataUnit}</div>`;\r\n        },\r\n      },\r\n    };\r\n  }, [\r\n    data,\r\n    dataType,\r\n    color,\r\n    chartType,\r\n    fromDate,\r\n    toDate,\r\n    xUnit,\r\n    hourLimit,\r\n    numberLimit,\r\n  ]);\r\n\r\n  if (!data?.length || !options) {\r\n    return (\r\n      <div className=\"w-full h-full flex items-center justify-center\">\r\n        {\" \"}\r\n        <Empty description=\"No data available to show\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return <ReactECharts option={options} style={{ height: \"350px\" }} />;\r\n}\r\n"],"names":["BarChart","data","dataType","color","chartType","toDate","fromDate","xUnit","hourLimit","numberLimit","dataUnit","chartFor","options","useMemo","generateSleepDistribution","xaxis","_","i","totalMinutes","hours","minutes","bucketCounts","item","bucketIndex","totalCounts","sum","count","distribution","generateSleepEfficiencyDistribution","totalDays","ls","generateApneaIndexDistribution","ahiValue","generateFallAsleepDurationDistribution","duration","calculateBreathRateDistribution","result","rate","day","validData","value","dayCounts","index","validIndices","validStart","validEnd","validTotal","heartRateRanges","calculateHeartRateDistribution","rangeCounts","min","max","totalValidValues","chartData","label","percentages","dataMap","percentage","_a","_b","allDates","start","end","dates","current","endDate","dayjs","_c","_d","date","formatValue","type","formatXAxis","weekNames","dateObj","params","fullDate","jsxs","jsx","Empty","ReactECharts"],"mappings":"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"}