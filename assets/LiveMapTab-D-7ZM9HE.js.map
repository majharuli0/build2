{"version":3,"file":"LiveMapTab-D-7ZM9HE.js","sources":["../../src/Pages/Elderlies/Components/TabContents/LiveMap/CurrentPeoples.jsx","../../src/Pages/Elderlies/Components/TabContents/LiveMap/LiveMapTab.jsx"],"sourcesContent":["import React, { useContext, useEffect, useMemo, useState } from \"react\";\nimport { WebSocketContext } from \"@/Context/WebSoketHook\";\nimport { CustomContext } from \"@/Context/UseCustomContext\";\nimport { Tooltip } from \"antd\";\nimport { FaUser } from \"react-icons/fa6\";\nimport { FaBedPulse } from \"react-icons/fa6\";\nimport { decodeMinuteSleepStats } from \"../../../../../utils/helper\";\n\nexport default function CurrentPeoples({ data = {} }) {\n  const { deviceData } = useContext(WebSocketContext);\n  const context = useContext(CustomContext);\n  const { elderlyDetails } = context || {};\n  const deviceCode = data?.device_no || elderlyDetails?.deviceId;\n  const [peopleDataState, setPeopleDataState] = useState([]);\n\n  useEffect(() => {\n    const newPeopleData = deviceData[deviceCode]?.position || [];\n    setPeopleDataState(newPeopleData);\n  }, [deviceData, deviceCode]);\n  const currentState = useMemo(() => {\n    const device = deviceData[deviceCode];\n    const lastUpdate = device?.hbstaticsTimestamp;\n    const now = Date.now();\n\n    if (!device?.hbstatics || !lastUpdate) return null;\n\n    const diffInSeconds = (now - lastUpdate) / 1000;\n    if (diffInSeconds > 90) return null;\n\n    return device.hbstatics;\n  }, [deviceData[deviceCode]?.hbstaticsTimestamp]);\n\n  return (\n    <div className=\"flex gap-2 h-fit\">\n      <div className=\"top-2 left-2 border-2 p-0 rounded-full flex items-center gap-1 pr-2 h-fit w-fit z-50\">\n        {peopleDataState?.length > 0 ? (\n          <Tooltip\n            color=\"white\"\n            overlayInnerStyle={{ color: \"black\", padding: \"10px\" }}\n            title={peopleDataState?.map((people, indx) => (\n              <div key={indx} className=\"flex items-center gap-2 mb-2\">\n                <div\n                  style={{ backgroundColor: people?.color }}\n                  className=\"p-2 rounded-full\"\n                >\n                  <FaUser size={14} color=\"white\" />\n                </div>\n                <div>\n                  <p className=\"text-sm m-0\">{people?.posture}</p>\n                </div>\n              </div>\n            ))}\n          >\n            <div className=\"flex -space-x-4 cursor-pointer\">\n              {peopleDataState?.map((people, indx) => (\n                <div\n                  key={indx}\n                  style={{ backgroundColor: people?.color }}\n                  className={`p-1 rounded-full border-2 border-white`}\n                >\n                  <FaUser size={16} color=\"white\" />\n                </div>\n              ))}\n            </div>\n          </Tooltip>\n        ) : (\n          <div className={`bg-primary p-1 rounded-full border-2 border-white`}>\n            <FaUser size={16} color=\"white\" />\n          </div>\n        )}\n        <span className=\"font-bold text-lg\">\n          {peopleDataState ? peopleDataState?.length : 0}\n        </span>\n      </div>\n\n      {data?.room_type == 2 && (\n        <div className=\"top-2 left-2 border-2 p-0 rounded-full flex items-center gap-1 pr-2 h-fit w-fit px-2 py-1\">\n          <div className=\"pr-1\">\n            <FaBedPulse\n              size={20}\n              color={`${\n                decodeMinuteSleepStats(currentState)?.statusEvents?.sleepState\n                  ?.color\n              }`}\n            />\n          </div>\n          <span className=\"font-semibold text-wrap\">\n            {decodeMinuteSleepStats(currentState)?.statusEvents?.sleepState\n              ?.label || \"--\"}\n          </span>\n        </div>\n      )}\n\n    </div>\n  );\n}\n","import React, { useState, useContext } from \"react\";\nimport Room1 from \"@/Components/RoomMap/RoomMap3\";\nimport Room2 from \"@/Components/RoomMap/RoomMap4\";\nimport { CustomContext } from \"@/Context/UseCustomContext\";\nimport useWebSocket from \"@/hook/useWebSoket\";\nimport { decodePosition } from \"@/utils/helper\";\nimport { FaUser } from \"react-icons/fa6\";\nimport { Tooltip } from \"antd\";\nimport CurrentPeoples from \"./CurrentPeoples\";\n\nexport default function LiveMapTab() {\n  const context = useContext(CustomContext);\n  const { elderlyDetails } = context || {};\n  return (\n    <div className=\"flex flex-col gap-4 mt-6 overflow-hidden\">\n      {elderlyDetails?.rooms &&\n        elderlyDetails?.rooms\n          ?.filter((room) => room.device_no)\n          .map((room, indx) => {\n            return (\n              <div\n                key={indx}\n                className=\"flex flex-col gap-4 bg-white rounded-2xl p-4 h-[700px]\"\n              >\n                <h1 className=\"text-2xl font-bold\">{room?.name}</h1>\n                <div className=\"flex h-full\">\n                  <CurrentPeoples data={room} />\n                  <div id=\"roomMap\" className=\"w-fit h-full mt-14 mx-auto\">\n                    {room?.mount_type === 2 && <Room2 roomInfo={room} />}\n                    {room?.mount_type === 1 && <Room1 roomInfo={room} />}\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n    </div>\n  );\n}\n"],"names":["CurrentPeoples","data","deviceData","useContext","WebSocketContext","context","CustomContext","elderlyDetails","deviceCode","peopleDataState","setPeopleDataState","useState","useEffect","newPeopleData","_a","currentState","useMemo","device","lastUpdate","now","jsxs","jsx","Tooltip","people","indx","FaUser","FaBedPulse","_d","_c","_b","decodeMinuteSleepStats","_g","_f","_e","LiveMapTab","room","Room2","Room1"],"mappings":"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"}